// ==UserScript==
// @name         Gebäude Übersicht_compressed
// @namespace    http://tampermonkey.net/
// @version      1.1
// @description  Eigene Konfiguration zum ein-/ausblenden von Gebäuden in der Gebäudeübersicht
// @author       Christian (LeitstelleHRO) / Jan (KBOE2)
// @grant        none
// @include      https://www.leitstellenspiel.de/
// ==/UserScript==

(function(){'use strict';$('.building_selection').each(function(){$(this).remove()});var a;localStorage.buildingListButtons?a=JSON.parse(localStorage.buildingListButtons):(a=[{ids:[0],name:'Feuerwehr'},{ids:[2],name:'Rettung'},{ids:[6],name:'Polizei'},{ids:[9],name:'THW'},{ids:[15],name:'Wasserrettung'},{ids:[1,3,8,10],name:'Schulen'},{ids:[7],name:'Leitstelle'},{ids:[5,12],name:'SEG/RTH'},{ids:[11],name:'Bepol'},{ids:[13,17],name:'PolHeli/Pol-Sonder'},{ids:[4],name:'Krankenh\xE4user'}],localStorage.buildingListButtons=JSON.stringify(a));var b=['Feuerwache','Feuerwehrschule','Rettungswache','Rettungsschule','Krankenhaus','Rettungshubschrauber-Station','Leitstelle','Polizeiwache','Polizeischule','THW','THW Bundesschule','Bereitschaftspolizei','Schnelleinsatzgruppe (SEG)','Polizeihubschrauberstation','Bereitstellungsraum','Wasserrettung','Verbandzellen','Polizei-Sondereinheiten'];$('#building_panel_heading > .btn-group').append('<a class="btn btn-xs btn-default" id="customizeBuildingFilter">Geb\xE4ude-Filter anpassen</a>');for(var c=0;c<a.length;c++)$('#btn-group-building-select').append('<a building_type_ids="'+JSON.stringify(a[c].ids)+'" class="btn btn-xs btn-success building_selection" id="building_selection_'+a[c].name.replace(/ /g,'').toLowerCase()+' title="Gr\xFCn = Die Geb\xE4ude werden in der Leiste angezeigt. Rot = Die Geb\xE4ude werden nicht angezeigt.">'+a[c].name+'</a>');$('.building_selection').on('click',function(){if($(this).hasClass('btn-success')){$(this).removeClass('btn-success'),$(this).addClass('btn-danger');for(var d=0;d<JSON.parse($(this).attr('building_type_ids')).length;d++)for(var e=0;e<$('.building_list_li[building_type_id="'+JSON.parse($(this).attr('building_type_ids'))[d]+'"]').length;e++)$($('.building_list_li[building_type_id="'+JSON.parse($(this).attr('building_type_ids'))[d]+'"]')[e]).hide()}else{$(this).removeClass('btn-danger'),$(this).addClass('btn-success');for(var f=0;f<JSON.parse($(this).attr('building_type_ids')).length;f++)for(var g=0;g<$('.building_list_li[building_type_id="'+JSON.parse($(this).attr('building_type_ids'))[f]+'"]').length;g++)$($('.building_list_li[building_type_id="'+JSON.parse($(this).attr('building_type_ids'))[f]+'"]')[g]).show()}}),$('.building_selection').on('dblclick',function(){$('.building_list_li').each(function(){$(this).show()}),$('.building_selection[id!="'+$(this).attr('id')+'"]').each(function(){$(this).removeClass('btn-success'),$(this).addClass('btn-danger')}),$(this).removeClass('btn-danger'),$(this).addClass('btn-success');for(var e,d=0;d<$('.building_list_li').length;d++)e=$('.building_list_li')[d],-1==JSON.parse($(this).attr('building_type_ids')).indexOf(parseInt($(e).attr('building_type_id')))?$(e).hide():$(e).show()}),$('#customizeBuildingFilter').on('click',function(){var d='<div id="buildingFilterCustomizer" style="background: #fff; z-index: 10000; position: absolute; left: 50%; top: 50%; transform: translate(-50%,-50%); min-width: 200px; max-width: 600px; max-height: '+(screen.height-10)+'px;width: 80%; border: 1px solid rgb(66, 66, 66); color: black; padding: 5px; overflow: auto;"><button type="button" class="close buildingFilterCustomizerClose aria-label="Schliessen" style="margin: 5px;">\xD7</button><div class="container-fluid"><h3>Geb\xE4ude-Filter anpassen</h3><hr><div class="row"><div class="col col-md-6"><button class="btn btn-success" id="newFilter"><i class="glyphicon glyphicon-plus"></i></button><label for="newFilter">&nbsp;Neuen Filter hinzuf\xFCgen</label></div><div class="col col-md-6"><button class="btn btn-success" id="saveFilters"><i class="glyphicon glyphicon-floppy-disk"></i></button><label for="saveFilters">&nbsp;Filter speichern</label></div></div><hr><div id="filterConfigurations"></div></div></div>';$('body').append(d),$('.buildingFilterCustomizerClose').click(function(){$('#buildingFilterCustomizer').remove()});for(var g,e=JSON.parse(localStorage.buildingListButtons),f=0;f<e.length;f++){g='';for(var h=0;h<e[f].ids.length;h++)0!=h&&(g+=', '),g+=b[e[f].ids[h]];for(var p='<div class="buildingFilter" style="float: left;"><div class="input-group string required"><div class="input-group-addon"><label class="string required " for="filter_name_'+$('.buildingFilter').length+'"><abbr title="required">*</abbr> Name Filter '+$('.buildingFilter').length+'</label> <button class="btn btn-danger btn-xs deleteFilter"><i class="glyphicon glyphicon-trash"></i></button></div><input class="string required form-control" id="filter_name_'+$('.buildingFilter').length+'" name="filter_name_'+$('.buildingFilter').length+'" size="50" type="text" value="'+e[f].name+'"></div><div class="input-group string required"><div class="input-group-addon"><label class="string required " for="filter_ids_'+$('.buildingFilter').length+'"><abbr title="required">*</abbr> Geb\xE4udetypen Ausgew\xE4hlt Filter '+$('.buildingFilter').length+'</label><input class="input required form-control disabled" id="filter_ids_'+$('.buildingFilter').length+'" name="filter_ids_'+$('.buildingFilter').length+'" disabled value="'+g+'"></input></div></div><div class="input-group select required"><div class="input-group-addon"><label class="select required " for="filter_id_selection_'+$('.buildingFilter').length+'"><abbr title="required">*</abbr> Geb\xE4udetypen-Auswahl Filter '+$('.buildingFilter').length+'</label><select multiple class="select required form-control filterIdSelection" id="filter_id_selection_'+$('.buildingFilter').length+'">',q=0;q<b.length;q++)p+='<option>'+b[q]+'</option>';p+='</select></div></div>',p+='</div>',$('#filterConfigurations').append(p);for(var r=[],s=0;s<e[f].ids.length;s++)r[s]=[b[e[f].ids[s]]];$('#filter_id_selection_'+($('.buildingFilter').length-1)).val(r)}$('.filterIdSelection').on('change',function(){$($(this).parent().parent().parent().children()[1]).children().children()[1].value='';for(var t=0;t<$(this).val().length;t++)0!=t&&($($(this).parent().parent().parent().children()[1]).children().children()[1].value+=', '),$($(this).parent().parent().parent().children()[1]).children().children()[1].value+=$(this).val()[t]}),$('#newFilter').click(function(){for(var t='<div class="buildingFilter" style="float: left;"><div class="input-group string required"><div class="input-group-addon"><label class="string required " for="filter_name_'+$('.buildingFilter').length+'"><abbr title="required">*</abbr> Name Filter '+$('.buildingFilter').length+'</label> <button class="btn btn-danger btn-xs deleteFilter"><i class="glyphicon glyphicon-trash"></i></button></div><input class="string required form-control" id="filter_name_'+$('.buildingFilter').length+'" name="filter_name_'+$('.buildingFilter').length+'" size="50" type="text"></div><div class="input-group string required"><div class="input-group-addon"><label class="string required " for="filter_ids_'+$('.buildingFilter').length+'"><abbr title="required">*</abbr> Geb\xE4udetypen Ausgew\xE4hlt Filter '+$('.buildingFilter').length+'</label><input class="input required form-control disabled" id="filter_ids_'+$('.buildingFilter').length+'" name="filter_ids_'+$('.buildingFilter').length+'" disabled></input></div></div><div class="input-group select required"><div class="input-group-addon"><label class="select required " for="filter_id_selection_'+$('.buildingFilter').length+'"><abbr title="required">*</abbr> Geb\xE4udetypen-Auswahl Filter '+$('.buildingFilter').length+'</label><select multiple class="select required form-control filterIdSelection" id="filter_id_selection_'+$('.buildingFilter').length+'">',u=0;u<b.length;u++)t+='<option>'+b[u]+'</option>';t+='</select></div></div>',t+='</div>',$('#filterConfigurations').append(t);for(var v=[],w=0;w<e[f].ids.length;w++)v[w]=[b[e[f].ids[w]]];$('#filter_id_selection_'+($('.buildingFilter').length-1)).val(v)}),$('#saveFilters').click(function(){for(var t=[],u=0;u<$('.filterIdSelection').length;u++){for(var v=$($('.filterIdSelection')[u]).val(),w=[],x=0;x<v.length;x++)w[x]=b.indexOf(v[x]);t[u]={},t[u].ids=w,t[u].name=$($($('.filterIdSelection')[u]).parent().parent().parent().children()[0]).children()[1].value}localStorage.buildingListButtons=JSON.stringify(t),alert('Die Filter wurden erfolgreich gespeichert.\nDu musst das Spiel neu laden, um die \xC4nderungen zu \xFCbernehmen!')}),$('.deleteFilter').click(function(){1==$('.buildingFilter').length?alert('Du kannst den letzten verbleibenden Button nicht l\xF6schen!'):$(this).parent().parent().parent().remove()})}),$('.building_list_li').each(function(){$(this).show()})})();
